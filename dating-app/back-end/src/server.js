var express = require('express');
const bodyParser = require('body-parser');
const bcrypt = require('bcrypt-nodejs');
const cors = require('cors');
const knex = require('knex');

var app = express();
const port = 3000;

const db = knex({
    client: 'pg',
    connection: {
        host : '127.0.0.1',
        user : 'postgres',
        password : 'rootadmin',
        database : 'matcha'
    }
});

app.use(bodyParser.json());
app.use(cors());

app.get('/', (req, res) => {
    db.select('*').from('users')
    .then(users => {
        res.json(users)
    })
    .catch(err => res.status(400).json('Unable to get users'));
})

app.post('/login', (req, res) => {
    db.select('email', 'hash').from('login')
    .where('email', '=', req.body.email)
    .then(data => {
        const isValid = bcrypt.compareSync(req.body.password, data[0].hash)
        if (isValid) {
            return db.select('*').from('users')
                .where('email', '=', req.body.email)
                .then(user => {
                    res.json(user[0])
                })
                .catch(err => res.status(400).json('unable to get user'))
        } else {
            res.status(400).json('wrong credentials')
        }
    })
    .catch(err => res.status(400).json('wrong credentials'));
})

app.post('/register', (req, res) => {
    const hash = bcrypt.hashSync(req.body.password);
    db.transaction(trx => {
        trx.insert({
            hash: hash,
            email: req.body.email
        })
        .into('login')
        .returning('email')
        .then(loginEmail => {
            return trx('users')
                .returning('*')
                .insert({
                    firstname: req.body.firstname,
                    lastname: req.body.lastname,
                    username: req.body.username,
                    email: loginEmail[0],
                    //photourl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSm2hIJK-htqNGFQUUtshHh934Z_J3CDlSe9H7UHLWln9by7CoS",
                    photourl: "data:image/jpeg;base64,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",
                    bio: req.body.bio,
                    gender: req.body.gender,
                    age: req.body.age,
                    sexpref: req.body.sexpref,
                    tags: req.body.tags,
                    city: "johannesburg",
                    longi: 28.0040,
                    lati: -26.0255,
                    popularity: 106,
                    img1: "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcT_rgwsrxDu-zJnmyGwji3SJ9lsBTaPYLrckA&usqp=CAU",
                    img2: "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcSocdUzNxOSyUaNdiZDEcg5tQGmUW_3DoiyIw&usqp=CAU",
                    img3: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMTEhUSExIVFRUWFhcXFxgYGBgXGBUYFhgYFxcYGBgYHyggGBolGxgYITEhJSkrLi4uFx8zODMtNygtLisBCgoKDg0OFxAQGi0eIB0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLi0tLS0tLS0tLS0tLS0tLf/AABEIAOEA4QMBIgACEQEDEQH/xAAcAAABBQEBAQAAAAAAAAAAAAAFAAIDBAYBBwj/xABLEAABAwIDBAYGBQkGBgIDAAABAgMRACEEEjEFQVFhBhMicYGRMqGxwdHwBxRCUnIVIzNikrLS4fFTY3OCosI0Q4OTo7OU4iREVP/EABoBAQEBAQEBAQAAAAAAAAAAAAABAgMEBQb/xAAqEQEBAAICAQMCBQUBAAAAAAAAAQIRAxIhBDFBEyIUMlFxsVJhodHhBf/aAAwDAQACEQMRAD8AlSfb8OdPB17xUCTby91SA6/Pur86/UJfn5tUk61ETTzv7vnfVRLOvz76fPuqMnXu+d9P/lRFVeLQ24QtSUyQRmIEhSUi063Qr1VaaVK1mLDKnvOqo8wPA0G6U4HrEtmYIcQnwWcvDcSD50bYbCEhIJtAk6nS5NdrrrL+rlN9rP0WAfb876QV7/nWmBXtO/8AnSzTHj861z26FPs+d1NPw3fyrh91cPw+dKm1PKvb7u+mZvf861xR9vups+/51pKaSBXsFJSvb7u6mBXurk+2rs0kzeyr+w1S8m/H9w86GA+z53UT2EJeH+b9w1viv3xz5vGGX7NcFcAfKPbTXSY3D1/Cut0119AOUqGY6CRJ8PXX1HxSyTqT5/C1FMCBkERvHkSKHJohhAcgiN/PUk6VrFjP2WaVZvpjth3CtZ24J7Igj7ygn315Dt36RMfnKOuQkWslJm4m5JPHhV7edRjWpu1749ikI9JaU95AoVjuleFa9N5I8QJ7iYBrwnFbRxTzTKutUtS0uyElX5xXXdWhIAME8tbeRzA/RzjDBWtlvjBKlf6QQfOtTDkvsb48fetttn6VMKxYIcWYSqEpNwpIUImE3SQfS31kNpfTU8owzhYEarVf9lIP71ZDp2nq8T1A7RbQ2lStCpSGm0TyEJFu+s9hGlKcSnLMqSNdQTFXpqeU7z4fV/WK4+qlV3Inh6q7WdRdvC88o/y+6q5IAJBVOvpE+01lsNi/zriZkmOBjs+r+VW3MUcp7R0r5GfprLNV+i4ueZS7ns2WfXu+POp557vnfWXb2gY1UbcT8avdH8ctzOFmYJjuzKHuqZcVkt/Q+pLdDs691OPdu+d1QpM+VPB1tu+d1cWlbbJ7Cf8AFY/9ieVEs3tHuoRttX5v/qMn/wAqaJHf4V0v5YzPzVMVe3530gfafnWowrnv+d9LrNL7z7+dc9tH/A0w+4fOlcz+yuTr3D38qLp0++m/z+daQ18fndXAffQrqVe7299dTcgc6kbwTqvRbWbD7JjXiatI2M8dUgd5HuNbmGV9oxlyYz3qmtsjyoj0fJ60n9VR9VSs7GdggrSLRvPwqzgtmdUoqCiTBGloOtduHhzmUtjz83qOO4WSqWzmHHkZnXnFdpQjNlEAxomBRTZ+zG0KCkpAI36nSoWltNwjrUA3IBWmTvVbXnyqsjpPggf+ISs8EBbs92QGvpTrr2fH652734agqA3jzq6zjm0pAKrxuBPsrFv9LmUg5WMSq0/oi2D4ulI8TUO1elJacLaWAYAMqeQj0hI7AClxzIFJdN2bHelLJxKMiLXQZVYdlWY6X4VhsX9GhdcU4vEQIHZSifRAHpFXuq+30nxSrIaankjEuH1obB75q/sHFYx19KXlFKCFAgMIbBGUxcurVrHCnn3TU15Eej/QVvC9X2utU2FBCliMudS1EgA+l2yJ4Va24Mc2CcNhmXgJMF7Ks2sAlTYGv95WoUKdFdZlk5XHH9HzH9IqVIx7vXIUgqyq7SFAKlCJKCZzAGRqdKGdHChWLw4EHM8ykADeXAPfX1LtPZjOIbLT7SHEH7KgD4jgeYvXmWL+i84bG4fEYQlbKX2lKQojO0lLgJIUfTQOfaEfa1rW/DPXy9bmlUGZXAftH+Gu1jbWnyLg9o4lSC11y8kWTNpzA6b9TU4Q+REjy/nUWwgZMc93dWmw2GcVZIRpN5Fc88sd6r18c5JLZQBlOLJgG3Hs/Ctb0c2c6hKity6twAtckzI51XwocKikdWSDeFcDFuNX8Pj1A5YRI58K55XGz2amPLvxf8irbKoHb3cE1OlhX3/9Iqlh8WqB2RpxPwqdONV9z/V/KuF+j/Z316lX260oMk5gYU19n+8Rzoiptz7yP2T/ABUK25iyWVAoi6DM/rpNF/rHEesVdcOmZfUbcyOcUnwUPea4jOdybE7zz5U84jl6xTEv8t53jvrHXga7epjmVzgn9pXwpQv7qdI9I/w1J1/L2U0vcqdOFfq+onx/hdwe1MPh2VOYpoKJcyojIfsgxLhSkXmpcN07bWSljCKgBR9NkDspKtGSs7tImhmMRnYgEgh4aZvuK+44g+s9xqTZmFlYJSpUNuiSlwgfmXPvtLAHcfPQ+rjwx6+Hk5M8+33Hr6b4pVxhkNiJ7aXyR3lxDQA11NVdodJsX+bAfaQVtIX2UsSrMVSUhbqjltqEqHM6CngcAEIEs9WTwaUjNGk5cIwR50W2y8U9UVFz/h0X6wJTMquQvGNSe+e/cOmo49lTZT2LdxDaVPvqCl9qOtCANRmyYVKAO9Yoa/s0qKi6HVATJcC4ANoUcRiQI/yRRnow+0rFNwEFecdorwq1EjhGIdWD3GaqoIFmlJBkkhC2Uxc3Bw+EUZ8fGknk7H9FMA11ycvV+i4RlXhCTCFEmGAVHvzRx4FrOEKrDOsFPogY98CeQQ2iPV3Ud2C44XbrdUMjmq8YsDsKiczLbWvG/C9UDglKSCWVKgb8PiFnzxL49Yq/KW+FVGzgmfzSkKEGThsO2Od8S8ojyo1t8pTiFpDgSRFjim2TGX7oQpyeZ8KpNMAAEIyH/B2egeanFRRXb+JAxDgLmW40xDDJFhuyFweJp42boOrqlQCttYJFlqx2I/dSB7KN9FcIgPgpbSPSkpwzjcSN7jip+NUvrdu05PD/APNeX5hpsUU6LKSrECC2ohB0+sqWJKQe272Ig6a1Ubau0qVaYpUqVKgVKlSoj5l6G9EsZiB1rTBUgKUCrM2n7R3KUDFteVGtu9Bsa4yUIYClSmwcZJsb6K760vQ7BOOJxKEuJYy5CEqcJAQkK+3lEi41G+iGO6MvobLqnmSkCZCyRJMAk5dLzS8GFva3zHb8Vnq44yarCdH2+qdSy+ktrDCGlpUlQIy9YiSI0Igg75oS3kTgnWlrSlSUvJTmtJCyU68ZMV7H0X2q+3gQooLy+tcSkplYKUm3aA9HhTMTt/GHVpYHDqzHrFbw4O3mXTy55zC/LC7PEpSRfsj2VcQNO6psb0sLhKENMEpUQVFpBJKfSAtBuQDY+q5vpR0tRgGsIU4FlxeIQkqsG0pJAnRBOp05183P0P3Wdn2cP/S+2faye2kksK7k/vJo59VRlB62CUgkQbHeNb1C79ILpRP5NwpkeiVTPL0PdQ5z6QlqEK2Th407DuUjxCQRWvwesdbZ/Hby3rQothH9qPJVr7703qU5o65PeZ4H4esUDb6QIcklBYNoSVhyeQUmJ8QPGnjaCJ1OvA8K8uXp85fyvZhz4ZTff+BYtJtC0mSZ3ZbxNzfjT1YdG51Ogm3Hh2r0FTtNs/bG/wCdambxrcemNOP86zOPL+lu8uP9X8Di8P8AmlBJDn51HohRF0qFwltw7p9AioNmbIWHwstgDI7/AMo72XBqdnp4/fGu/wBErB4ltTakktqPWNqAVkMwFAmF2tVrZ6UF0GGbJc0SxN21j7KSa+jwyzB8n1N3yWhuE2atKbMrTxysD3YJNFccyodV2XZDCBID4ggqserQIPIweQoYNkIIkMJVpo0n3YRVXdp4D9CBh80MNiA2oxBVa2BVHd2fwjU9dvOsbE684hoqWvLmuIxQmx1zOBJH4kkcqphpQMkrP4vrR/exseoVc2Hs+H21FpSIUYltKdx44NBGu5STzqgvZyY1A/8Ajj24Gp8nwv7DQS/Kkj9G72sl/wBGq0qxaz/p8RrVHBsNpABbQP8ApYFPtxCqtdHWUh6M6Cerdtnwx0Qq8IwravX3zVNp5IAAdb03YjAj2YYVfkEWsOnMMqkCSN2zgddBAJ9dENq4hScQ5BT6X/8ARhm4t91balT3mhuz8QStADqD2k//ALOFO8aBLAJ7hRHajig+4AUgBVh9Ywzcf5FoKh4mnyK31oi5cWO7aDQHklECjPRbE53iOsKoQTH1sv8A2k3yZQB3/GhKXzvWB3YnCH/YKOdF15nFdsqGX+0ZXqR/Z33VUagUqVKtMlSpUqBUqU0qGnzq/j3EhDrSjlWgkBUDNBhUZtbx5Vr/AKMdquKQpsDLklYuNFntSQSkjsiOE869B2p0PwT5SpxgBSJyqbUtpSZ1gtFJGp86xvSXoyvZ604zCOFvCtJKsUhTjrji0yknIVBZ0SLyI13mmfa46MJJltcd6auNlTbLAcUhx1LmYqkrnMkjICct40O7hWf6SfSqgsu4ZzDpU8oABLbpUlNzKlqSBlKSE9kSSdYrzHpR0tcdW4GQ4w06rPfsuKtvIsByGvqrNYcwCeNMZdeWstb8NDtHpY+qEpyMoGiG0JQnxi6u9RJols7aKXWe2SlQmSCYMCZgco8qx6VRVvAYiMyeIPsIrTO2pGzVFIV1i4MEdkJt+1mHiK5+TxPazqj+8j1BA9td2DtHOwEk9ps5TzH2T5eypHHKCXDKDZzIbRIMgnOojxKqtK2w7xR+yr+OhRcppXQFDtd4/aR+yf4q4NsPfeR+x/8AahJcpinKC9tDbDwEjqVcQpF+8dq9D8N0iev+aw/IhBHsVTcaQUHfae48fCgTiwqUTBj5FAdPS1c+ilJ3glZB/wAqlERRbCdM80ZmmSUAJHYQTlG4Z0kAXO/fWJCc4CVEZxp7gTFNbSQcpkHS2tB7d0T6RMOPoSAEKk6hCdx9EJWmfAKjhRFhGZIU2Qfwkn1tYyvC2sVBAUYM9lQnXcZGh5yD3a1sdg9MlNkIxBK0SIUerhI/XzNLkcwBzA1rncPmNTJ6tskOZlZi9+jX6SsXl9Ex+kWtHrnhVFl5xJglzxXtBHrW0oVNsEsKUpxrqjLTklIw0mR/dhKo8hxin4XCAEQj9ltcT/0cQqPKsfKnsY0haAXNVpF3idVAfbZE901JtB7865K8oCyLP4dMd6XEiPEmpMOhXXIlTie0myl4xH2h98FCu72VzFv/AJxYLlgtVuvaEX0yOI7PdNX5FVCpFu2OI+oueuL+dHejKSFrkEWGrTKN/wB5ome6hQM3AmdClOEdnyynymjPRxnKpZ6sosm5ZS0VXO9KiFeqtRKPUppVyqmiJpVyuVNrp2aVcpVV0zG1emAwTC3cUmcvo5NXVH0UgHQnjMC5tFeJq+lPGHEpfW6sIKyS0kjq8v3ACNwjvvNM+l/bynsSGc8oZERwWqCokDlAHdWHaxa0pKQYBMmwvpxHKtRmt9036cp2iwhlLPVhKs6jZRKoICQQkaSfGKwGUiJBGsT6zUica6PtueCzHqNdxG0HViFEkAzczfjeqiNdtfAfGuIX2pqIyTen5YMUBbYmIyOgA9lxN/xCfgfOjq11jA4UqBGqTI9XwrV9YCARoQD50EuemqNRFVRlyglKqaVVEpdcz0EhXQjaGHAIUB3fw0RzVG6nMI+RQCUqzAKiSNRxp5dKhfX2jgedRugpVykyOZifYKdkGvGgY25qFXHrq5h3AIBuKoPG8intu8aDX9G+kj+BJ6tRWwoEKbmwzCJTqAeUQfVWy2n03YThkPNhtTioCULQ0r8UqQ2kpPfFeUYfElOhsfI94qYspXpEE3TOk2lJ+fHdLJV29e6D9N8NiHG21BLDqlpGWHUpUSoCElKymSbQRetliMV2lDrIAJsXsu/7rrZT4AmvJPo82Hh2cSziHnlJyOJUnKAUiDbrDmOUazaxr1hO0m1Zil5JTmJs64Br/eJUjwFq55TV8LPZ0JC/sBWhsjDPSOPYKTRjo8wE5+yEns/8tTdr2gkgxyoQhCV6JCzyQw9HOWilVGdgtBIXCQkSLBLiI1+y4SB4UWixNNJpKNMJqh01zNUKl0wuUFnPSqnnrtNK+U+nQKsdil7uuUnxA+AoM1qK0nThofW8WmwPWhXM5wkj96s42NDXRzSYhtMyBAqIEjQ1O7pUIoJMKoaHy+B3eypmSkLPWN5hOklJjcQRVNad4rqVmaDQo2Oy/wBppwoP2kESeRFx7xRD8muISlKR1lgJEJiLXClTpWbwD8KmtXsnaDZMKMHcrd40HW9hun7TYPAqPwpjuw3k70eZ+FHUrExPdwP8+VPUKDMnY7v6vmfhUati4knshs+Jn1JrTKFNS8RooigzC9gYwa9UPFXwpv5FxO8t/tH+CtS5jVxGb2A0Jxq8RMpenkfiLUAdfRrEKupxv1n/AG1Qxey3EKyqIB7jB5jlV3FbTxCT2lqT4W8xaqOJx7i/SWVd9BSXh7xmnmBYeurKcCN6vd76inn7aZkHGgKNYBr75PeQK4ytLaygoCt4N5vyJoUURfhRLCYgOAz6QTHeNQe/d/WgvrxCSZCR4/DSrGF2itJJStSTxBIMcJF6EFR0rocoNhgOlzqTC8i/xoSf9aQFec16Z0K6ZtLHVryoWYITKrjQFOYkH/KTpXgBeqzhceU21Tw4HiDuPzepYu31ajFJWJSZril14FsHpy9hynMoutGwUfST+qrn893q2y+luHfQFJcEnUHWp10u2hKqhU5QxW2m96tdNY8zE1AvaYXKW5Uq4Ea6T4VFgl9dTxPkfhSrNfk7FfcH7Z/hpU2uq8f+kZak45xJAKcoIMDMT1SdTrYway7zdpFbT6TDlx/WBOYFiQFcSlTZNuEAjurGYcEgTwEVuOZrVwQajUinC1dbB3UENPdF66LG9VlOGaCUKqRD5G+oQbUqDQbN26U9ld0+z4ij7O0YAvKdx1/qOf8AWsDNXMFj1N21HD4UG6Tj6S8SDWdZxYIkG3D4fCpw9zoCpdqNa6HddBmpi5NA50zb+nlQ57Bov2Y5p+FWlKqBTlBQewMXBKh5EeG+qSouBrwNp7qMFwdxqnimAb6HlofhQDS9uKR6/jUjT2X0YHHj5601aToRPtqLqzNAVcdzGePwqLrKqoXFSlU0ExINRmRTQadmoJWMTHMGxHEe48Duojs3HqZUMqjlPomY8JGhHzag5pyV2ynQ6HgePu/pQezdG8I1ikBYxDhULLQIkW5zKbW1oy10ZQkdl96QQoKzJCpSZBsncf5zXj/Q/pM7hHkuINxYg6KG9KhX0tsXFsYxhD6AkpWN2qVAwpJI0IUCPCsXFuZBvWOcU+R+NKj35Na+76z8aVTrV7Pnv6U2RLbpEQlxuI1KoKe7VZ8K85LwCBBvoRvHMeFe67Z2Q0+2WliQbpA1JuZkGbd15rA7U6DNJJyqc4gGNLQT8K1Kz1YZoyOYpzTkGjGK2J1c5ZnnxFCFJ5d44VpLEr8ZSeVQ4LBFyYkmLAXJgSY7henLPYPhRDZeJLfVKBBSHQTxBUCk+r3UQJDZA8iOYNqUUT2vh+reW0d0xwgqWR6iPKhrZoGxXYo70X2c28+lpZSOtCkIKpA62PzYkERJtwmKE45hxlam3EFK0EpUkiCCNRXX6X2d5f8AjEzna4uMOlJq83id4qqy3mBNrCTfThJNvXUjrBRrbyI8xI9dc9NrqcSDU6HqEoPAjzqZJNQES7NRLXVTOa51poJHDUClmulymKVQMUqozTzTSmgjp00X6NY5tl3M6gKBjtFIUpETOUKCkgkHUoWLAZbyLnTLG4V9zrMM220mwShCcpy9q7gBIz+jJkE3JAtAZ0LpZ6aRxqy3s90iQ2qPvEZU/tKgeuggz00rqycKkek60nlmKz/4goeuudU2TlQ4VLJASOrICibAZiqb/h8qBuEbU44htAKlrUEpAuSSYFewfQ90gGH2hidnKV+bW4vq72DrZIUB+JI/0DjWeTsxGxGOucUlzaLyYYQLjDhQguHmJgHjYWBNBOh2KcQ9hwkjMX0LJjtSFgm++YjxrtnJjh1+a5YZd8u09v5fVkUq5NKvPuOzzbKSLg9mefEg2vp/ShTrEgRoR3GfMR891GsWkyZIEQDEHXgTvBO8RrVR9uOfaiN0m41Fzu8ay2yWLwQ0iZNzaRw3eccaxXSXZORWdMR9oDdzr0zHsFQnWCZIkgRyBA11jjumgW0MGkhQIGkQZmDIsDutpUl0WPLXRANLClQVp2VWM2HCZNhE+ur22MCWlEag6HdVJnFKCcpIKb2In5uRXVzWcXig451hvlbAPM+j7VVTeRc1exaEJwrOVQUtS3C6mPQCCAi+8KBJ8KqKMweVBNgTIIkgiCCLEHcQdxBrW47beG2gltG0FKw+IQMoxCEBbbotBdSO0FcxbXTSsW25lMip/rYVZQrpx8lwu4558cz18WfLQOdA3FSrC4nD4lO7I5lVbiFwAfGqGJ2LtDDg52HMhuZR1iO+RI8ZoV1QmUKynd/WiGF6QYxr0cQ4I4nOP9UxXaZ8OX5ppz68+PtZl+/j+P8AQQ69P2AO6R6pirGysG884ltpJKlc4gbySbJSN5Nq0LXTHEq/SIYxA/XQlR+fCpXunDqW1IZwrTGb0ihCRPgEifGRWpxcE83NnLk5/aYef38f7W8dszAMhLbzuK62O0pAbUiY9IJUArLwvPIVmEtJOdZdytJVlByy4sm4ARmgWuSSB36UNfxClqKlqJUTJJ1Jp+EdHaQr0VwCfukeirw9hNY5+Tjy8YY6dOLjyxn3ZbWl4rDjRD6uedtHq6tXtqL641/ZLPe6PcgVSdbKSQRBFMrzOy/9db/sf/Ir3V3683/YD/uOfGh9KgvKxbZ/5ak8wufUoGfMd9PSworbSCCHMuU/iUUCRuMg25UOFH8P2X8Mm3ZbbUe85nQO/tDzoKLu0iklLPYAtmEZ1cyvUdwgDnqaLzylGVKKjxJJPmaaE1InDq4R329tBFRHYmIU04l9KQpTZ7AIkFcGDG+Ne8CoUYZI9JRPJP8AEfcDVhGJSk2AEaC5/rVl15PdYxuIccWp99ZW4rUkySdw5e6td9G2yCt9tyCe0kJHEyJPzwrDpdzqzK0Enyr236D8PnS2s/ZQszz6xQplbbukmpqPYcg+TSp1KpqK88fQoDsx2BItmibXg2gb4OtVs0i6pt2bWjjrzNhpV76unKFiQSRorNA1uVXiI3VSfTKoIiQVSRBjQidJg8Z0tWG1V0RbKSJsTAEAXBy3IJBjXU0PxWGlEaRuAgq3EnMSTvPwoo8SqwSSi0gFVgdBa2WN49l6YtoE2N0gE8IFtb21O711B590h2eHE3IBJJTJiSTdN7acLTXnbzSkdg2M+z5Ne3Y3CAA2SSBlv6W+JSLQTPHu3V5p0rwyQ8tZuVICkkGR2RB1jcnTdWsazlAxjFFpIKkZswSQCbCwg8DaDp6xVZ1ZJJIgkqMcJUbVacxnWtNNwAtAyg/eFikTu+15DjVR5wqlRMkqUSeJJk+2tMoVmmV1VNoFNPS6Roajiu0EvWg6jxFjU7WIV9lU8la+ehqmTXBQXTjdxQJpisQk/YFVqaDQWC9ugEcDu7iLxTcyfueR+INRzXDQP7PA+f8AKm24eum0qB6VxcAe3205b6icxJJmZ3z31FSoJ1YpR1UfM1FnNNpUHSqlXK6kbqC6tOVscVX8rD31779AjQGDCyRoQP8AuuXrxROzAtvNmIIUltACc2ZREqJ5X3byK+jPo42L9VwLTWZCnAntlJkAlSlRpNs2lrzWcstRY2OccaVVOqP6v7Ndrn9Wr1Yx1kntCAqJE27P2svjvioEoN1FOUjSe0VHWQVRxM38amQ2lSr5Qsg5gPS9ETAEkmbW86QbhOUhKYncSTJ8BJ4Ga20orSUwSpKheYkA3ggQSBbkdalyqUAICRfMLcY0vx33tTS2dJJJy5TEgSc0gGTpPAW50lBR0IEgzZUk3BgkhIPOeM1FUVsSIMGTvFpO+CJzC5k8fGsN9IOzfzedKfQsqQQSlQyzzvflevRUtoJgKzA6RpIMqUSNLRYW5XoXtbDyCkpkEHskDLl+1J1JiPZT2Sx4Y4gBKTI0GhvIP86hQez4mtF0g6JuNLJbOZrcZBIEwRbWNJoG9h1JtkUI4pIPjNdNsaVzXKkU0r7prgbPCiGUq6U1NhmAT2lpA77mgr12iJwzR0I8DXDgBuX76AdSIq05gFDSD3VXKdx1oGUq7kPLzFINnl5iroNpU/quYp3UniPXTQirtT/Vufqp6cKOZoKtdFEm8IngPG/ttVlrDxu8qm4ugpOFWfs+dX8NsV1XoxPMx5GjOFwhNwLfP86ObPwdxuA+YrNyWYrXQ3Y6kBJcylaCopvIClZRmI32Tr6q9CwaVCCFlJk3BuJ32g8r1mtlYeN/O0zWjw8xv0+fnlU81fEFvr7n9q56/jSqnB+ZpU608HutrAXDg7OgIzEAQRYCVTMb799cKRllRCbdsCEkm98xjMdLC8bhXOpUnSNAUkJz3I3gq1uRxqRJWWiACAlVyYKwn7wSDrvsZPfRVMgJCUlS5k2IGdaeJSmwTERMG82gCmoaymwspUFNo3jUGYk6irTqirKS0YGi0AGxv2oukSDbWnPIJSmZJOWE3hPGLSdd/HxqbAxLUoBiLZU5IsSIKRAJgxu1teqzuHzK0CspzL1BOsCJ9K8SZFhzoklaL/ZVfSVKBtAyx6E3MnUVxzDLWOyEpBFwq5IBEkAnmTYDTfRdhZZUo5bEAG/ZyqG7Pb0bAQkRM62FBtobIzE5gnmSPRJ3Df6RCYiTBsa0L6SV5N64+1ui8kXIMbhqq8XpLZCjluRE5QB2DcgAZLiw3m3jUHnuP2MoEpUk5gjMLWv9gAcPIwaC4jZwPogW111HDl/SvVfyanq7JI7Vs+YBUSLBUcIsKDvbAUdG1IKBYyo5pgHQQRAmBpBvV2aeZLwHagX430tO/fVd7BED0SPZax9ZNemvdG1EmQnQyofave8QCLA94vehz/R+HCgJJkKMHQZY8bkjXeeVXbPV527hdYvwphwthz0rdv7APoxlJFha+vaiO63sqq9sEgAb+QMd0cavY0x31Y/PzauHDnW55i9a9exFCMw8TZIzA2nXgZteuI2MqMyU2nvkab99NppkixwvypdQf6VtfyAZJiJvGu7vtUzfRs8LaC3n/WrummJbwk6f18ambwpG7w8a3jXRc27PCefw36catsdE+I759dPJ4YRrZ5OgN+VWk7HOt/dXoeF6LpHGOG6iCOjaOdNUeds7J5erlRLC7En5mt83sJA+zVlvZSRuFOqbYzC7IiNfL5vRnC7NV93xrSt4QCrKGhTS7CWcAocKuN4M7yaIJRT8tVFP6uOHqFKrmWlRFF0KyqSVSm3ahCc3eVFMQCbAGQNaa0i0qzHsptISCRuQBqDPpawk+NvDJ7ZSIkQQDCkovvCTMR4XA3mocWgLC0kqgQoQJmZgb4EqBOmlc3RHKFGZUIIIBXaZy8RE3Ou7vri8NlSuC2StUQQRJgjLbN1aLaX9c1cbkhKUFBSkxBChMWUEgQUaaAECagTheqK1ZhC5CkqWAnimAtPZAB0E0ET5WiF5QCAEkSQJkQAkk9kTHLWkthaZAcSSbSURFxlQqwzaiwmSOAq26sGcxHa0yyfSAuQbp17ooe2+ASjPCh2UnKFaaRJjW3fHKoF2bpWpQNjASDIkRNiBETYiyrRSDRWCpMgnKokSZTBubC3KxAtNW0rOYqGpGUC0CAZukSOO+6juFV8Y6kyhOYncrs9k242BVEeB0iiqj+GIjIVAKy9pYKgIAlRSZgCY1TXX8EleWVCZKkSMxFr75Kbm3627SrqGHPtrJEgdlKiEqUQEwIMAbyTrBqJuEqTATxkrjPJhRBuATCrA3ndQVDhSqFEgJ36GYtBAIMC8+INVmUFRKYlFwSEqEHMm4OW+pO6Qk94IPMFfWJJBgjKkK7WS+YjL2gRmB369wpmDiwAWlAB3k58ukkDNJMyEiKCg7gJKiNUqgFN5n9WJm106bxUn5JQ5e+WJVmDczqZtG6eNvEElKMnOv0jCpBhIAKsgACSkQdZimBsKX1kwpWUhOeTlTY5QknMmBJgz2jJuBQDcLshMDLkgwRJUZUbG5MzG+d9rTTV4JAMBAULyZBjfASZJ/lrRZbYSoqBHG4VAVyHAWjuFq4tlVoUQALkkyqTmgSLDXTjrQVWcGk6QR7D7u6rzOBTwFSIXIkzw0MnfMU5BvyrcrFJGEHAVMjDCpmr08VplW+rxuFc6urc1wpqiuEU4IqQiuA1BzJXctPAp0UEYpyadlpAUHMlKu5aVAOwH/DO9zntTUzerX41e1NcpVydVrafon/B9yaB/84fjV+6KVKqzDcf+hT+I/v1LgdfE+wVylS+yim1v0SfneKotfoVfjb9lKlUgrt6L/wADE/8AsVRDE/omf8n7hrtKipWv0S/8VX+2h6f0jv41f76VKoON+niP8Ie6mbL/AOCX+A+xFKlQd2h6SfwJ/ebq2PRT4fvLpUq0GbO3ePvqc7qVKk90yLD+l4fCrS65Sro5nbqSdKVKqEnfTV7qVKgcN9dFKlSjh99PT76VKoHUqVKg/9k=",
                    img4: "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQ6p_weJxjKCsTycF-csbM9HNY8aRbsAXttGA&usqp=CAU",
                    logged_time: new Date(),
                    is_logged_in: false
                })
                .then(user => res.json(user[0]))
        })
        .then(trx.commit)
        .catch(trx.rollback)
    })
    .catch(err => res.status(400).json(err));
})
 
app.listen(port, () => console.log(`matcha app is listening at http://localhost:${port}`));
